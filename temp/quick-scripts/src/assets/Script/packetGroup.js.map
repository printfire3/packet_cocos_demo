{"version":3,"sources":["assets/Script/packetGroup.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mCAA8B;AACxB,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAyC,+BAAY;IAArD;QAAA,qEAqDC;QAnDC,kBAAY,GAAc,IAAI,CAAC;QAE/B,cAAQ,GAAY,IAAI,CAAC;QACzB,cAAQ,GAAG,IAAI,EAAE,CAAC,QAAQ,EAAE,CAAC;QAC7B,cAAQ,GAAG,EAAE,CAAC;QAMd,kBAAY,GAAG;YACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;gBACtC,IAAM,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;gBAC/C,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;aACzB;QACH,CAAC,CAAC;QAEJ,OAAO;QACP,iBAAW,GAAG;YACV,KAAI,CAAC,QAAQ,CAAC;gBACZ,KAAI,CAAC,YAAY,EAAE,CAAC;YACtB,CAAC,EAAE,GAAG,CAAC,CAAC;QACZ,CAAC,CAAC;QAEF,OAAO;QACP,kBAAY,GAAG;YACb,IAAM,IAAI,GACR,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC;gBACtB,CAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,GAAG,EAAE;gBACrB,CAAC,CAAC,EAAE,CAAC,WAAW,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;YACxC,IAAM,GAAG,GAAG,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YACtB,IAAI,CAAC,MAAM,GAAG,KAAI,CAAC,IAAI,CAAC;YACxB,IAAI,CAAC,YAAY,CAAC,gBAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACnC,CAAC,CAAC;QAEF,WAAW;QACX,0BAAoB,GAAG,UAAC,QAAiB;YACvC,IAAI,KAAK,GACP,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;gBACvB,CAAC,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YACpD,IAAI,KAAK,GAAG,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;YAC9D,OAAO,EAAE,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC7B,CAAC,CAAC;QAGF,UAAU;QACV,iBAAW,GAAG,UAAC,MAAe,EAAE,KAAc;YAC5C,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC1B,KAAK,IAAI,KAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACjE,CAAC,CAAC;;IACJ,CAAC;IA7CC,4BAAM,GAAN;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IARD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;qDACW;IAE/B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;iDACO;IAJN,WAAW;QAD/B,OAAO;OACa,WAAW,CAqD/B;IAAD,kBAAC;CArDD,AAqDC,CArDwC,EAAE,CAAC,SAAS,GAqDpD;kBArDoB,WAAW","file":"","sourceRoot":"/","sourcesContent":["import Packet from \"./packet\";\nconst { ccclass, property } = cc._decorator;\n  \n@ccclass\nexport default class PacketGroup extends cc.Component {\n  @property(cc.Prefab)\n  packetPrefab: cc.Prefab = null;\n  @property(cc.Node)\n  mainNode: cc.Node = null;\n  nodePool = new cc.NodePool();\n  poolSize = 50;\n\n  onLoad() {\n    this.initNodePool();\n  }\n\n  initNodePool = () => {\n      for (let i = 0; i < this.poolSize; i++) {\n        const node = cc.instantiate(this.packetPrefab);\n        this.nodePool.put(node);\n      }\n    };\n\n  // 红包出没\n  startAction = () => {\n      this.schedule(() => {\n        this.genNewPacket();\n      }, 0.5);\n  };\n\n  // 生成红包\n  genNewPacket = () => {\n    const node =\n      this.nodePool.size() > 0\n        ? this.nodePool.get()\n        : cc.instantiate(this.packetPrefab);\n    const pos = this.getNewPacketPosition(node);\n    node.setPosition(pos);\n    node.parent = this.node;\n    node.getComponent(Packet).init();\n  };\n\n  //红包随机生成的位置\n  getNewPacketPosition = (newEnemy: cc.Node) => {\n    let randx =\n      (Math.random() * 2 - 1) *\n      (this.node.parent.width / 2 - newEnemy.width / 2);\n    let randy = this.node.parent.height / 2 + newEnemy.height / 2;\n    return cc.v2(randx, randy);\n  };\n\n\n  // 回收相关的节点\n  recycleNode = (packet: cc.Node, score?: number) => {\n    this.nodePool.put(packet);\n    score && this.mainNode.getComponent(\"main\").changeScore(score);\n  };\n}\n"]}